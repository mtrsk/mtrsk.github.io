<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
  CAP Theorem

    </title>
    <meta property="og:url" content="https://mtrsk.github.io/notes/2024/cap-theorem/">
  <meta property="og:site_name" content="Benevides&#39; Blog">
  <meta property="og:title" content="CAP Theorem">
  <meta property="og:description" content=":ID: 74c5509d-73be-4b04-9ca4-039117d588a9
First postulated by Eric Brewer in (Brewer 2000), and formally proved in (Gilbert and Lynch 2002).
Definitions For (Brewer 2000), a distributed system has some very specific properties and behaviour, being a collected set of Nodes that all share data. A limitation of such systems happens when a write request is followed by a read request.
┌────────┐ │ Client │ └────────┘ [R] ^ | [W] | v ┌−−−−−−−−−−−−−−−−−−−−−−−−−┐ ╎ System ╎ ╎ ┌────┐ ╎ ╎ ┌──────────│ a0 │──┐ ╎ ╎ │ └────┘ │ ╎ ╎ │ │ │ ╎ ╎ ┌────┐ ┌────┐ │ ╎ ╎ │ a3 │───────│ a1 │ │ ╎ ╎ └────┘ └────┘ │ ╎ ╎ │ │ ╎ ╎ ┌────┐ │ ╎ ╎ │ a2 │──┘ ╎ ╎ └────┘ ╎ └−−−−−−−−−−−−−−−−−−−−−−−−−┘ Read Write A client can read data from the system by talking to any Node A client can write data to the system by talking to any Node The Theorem states that for any given pair of requests this kind of system can only guarantee two out of three properties:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2024-07-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-11T00:00:00+00:00">
<link rel="stylesheet" href="/css/main.min.1135c79bd24c232c465ba2c4e5a9644086ce3f8358dbd0e0d76c5e86d24f1fad.css" />
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  </head>
  <body><nav>
  <img
    src="/img/logo.png"
    alt="put your logo here"
    width="128"
    height="128"
  />
  <div>
    <h1>Benevides&#39; Blog</h1><p>&#34;Writing is nothing more than a guided dream.&#34;</p>
  </div>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/blog">Blog</a></li>
    <li><a href="/notes">Notes</a></li>
    <li><a href="/blogroll">BlogRoll</a></li>
  </ul>
</nav>
<main>
  <h2>CAP Theorem
    <small>
      <time>July 11, 2024</time>
    by Marcos Benevides


    </small>
  </h2><p>:ID:       74c5509d-73be-4b04-9ca4-039117d588a9</p>
<p>First postulated by Eric Brewer in (<a href="#citeproc_bib_item_1">Brewer 2000</a>), and formally proved in (<a href="#citeproc_bib_item_2">Gilbert and Lynch 2002</a>).</p>
<h2 id="definitions">Definitions</h2>
<p>For (<a href="#citeproc_bib_item_1">Brewer 2000</a>), a distributed system has some very specific properties
and behaviour, being a collected set of Nodes that all share data. A limitation
of such systems happens when a write request is followed by a read request.</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">       ┌────────┐
       │ Client │
       └────────┘
     [R] ^    | [W]
         |    v
┌−−−−−−−−−−−−−−−−−−−−−−−−−┐
╎         System          ╎
╎              ┌────┐     ╎
╎   ┌──────────│ a0 │──┐  ╎
╎   │          └────┘  │  ╎
╎   │             │    │  ╎
╎ ┌────┐       ┌────┐  │  ╎
╎ │ a3 │───────│ a1 │  │  ╎
╎ └────┘       └────┘  │  ╎
╎                 │    │  ╎
╎              ┌────┐  │  ╎
╎              │ a2 │──┘  ╎
╎              └────┘     ╎
└−−−−−−−−−−−−−−−−−−−−−−−−−┘
</code></pre><table>
<thead>
<tr>
<th>Read</th>
<th>Write</th>
</tr>
</thead>
<tbody>
<tr>
<td>A client can read data from the system by talking to any Node</td>
<td>A client can write data to the system by talking to any Node</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The Theorem states that for any given pair of requests this kind of system can
only guarantee two out of three properties:</p>
<dl>
<dt>Consistency</dt>
<dd>The system can read data that is (at least) as fresh as what has been just written.</dd>
<dt>Avaliability</dt>
<dd>Every request received by a non-failing node in the system must result in a response.</dd>
<dt>Partition Tolerance</dt>
<dd>The network will be allowed to lose arbitrarily many messages sent from one node to another.</dd>
</dl>
</blockquote>
<h2 id="idea-of-the-proof">Idea of the Proof</h2>
<p>Here is a sketch of the proof provided in (<a href="#citeproc_bib_item_2">Gilbert and Lynch 2002</a>), consider the same
system as before, but focus on a pair of requests (R/W) and two nodes.</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">                [W]
    ┌──────────────────────────┐
    v                          │
┌−−−−−−−−−−−−−−−−−−−−−−┐       │
╎        System        ╎       │
╎                      ╎       │
╎ ┌────┐        ┌────┐ ╎ [R] ┌──────┐
╎ │ a0 │ ────── │ a1 │ ╎────&gt;│Client│
╎ └────┘        └────┘ ╎     └──────┘
╎                      ╎
└−−−−−−−−−−−−−−−−−−−−−−┘
</code></pre><p>Assume, via contraction, that such a system does follow all <strong>CAP</strong>
properties. Given a network partition between <code>a0</code> and <code>a1</code>, the followig will happen:</p>
<pre tabindex="0"><code class="language-nil" data-lang="nil">                [W]
    ┌──────────────────────────┐
    v                          │
┌−−−−−−−−−−−−−−−−−−−−−−┐       │
╎        System        ╎       │
╎                      ╎       │
╎ ┌────┐        ┌────┐ ╎ [R] ┌──────┐
╎ │ a0 │ ──//── │ a1 │ ╎─??─&gt;│Client│
╎ └────┘        └────┘ ╎     └──────┘
╎                      ╎
└−−−−−−−−−−−−−−−−−−−−−−┘
</code></pre><ol>
<li><code>a1</code> will never receive an update from <code>a0</code>, which will break its avaliability promises (by never delivering the new result)</li>
<li><code>a1</code> sends stale data back to the client, breaking the consistency property.</li>
</ol>
<h2 id="references">References</h2>
<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>Brewer, Eric A. 2000. “Towards Robust Distributed Systems.” In <i>Podc</i>, 7:343–477. 10.1145. Portland, OR.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_2"></a>Gilbert, Seth, and Nancy Lynch. 2002. “Brewer’s Conjecture and the Feasibility of Consistent, Available, Partition-Tolerant Web Services.” <i>Acm Sigact News</i> 33 (2): 51–59.</div>
</div>



   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   





<footer>
  </br>
  <p>
  Built with <a href="https://orgmode.org/">Orgmode</a>, <a href="https://www.gnu.org/software/emacs/">Emacs</a> and <a href="https://nixos.org/">Nix</a>, source code availiable <a href="https://github.com/mtrsk/mtrsk.github.io">here</a>.
  </p>
</footer>

      </main>
    </main>
  </body>
</html>
